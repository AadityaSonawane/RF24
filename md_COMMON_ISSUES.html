<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Optimized high speed nRF24L01+ driver class documentation: Common Issues</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Optimized high speed nRF24L01+ driver class documentation
   &#160;<span id="projectnumber">v1.4.1</span>
   </div>
   <div id="projectbrief">TMRh20 2020 - Optimized fork of the nRF24L01+ driver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Common Issues </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1"></a>
Settings that must match</h1>
<p>Before you report undesirable behavior, please make sure that the following <a class="el" href="classRF24.html" title="Driver class for nRF24L01(+) 2.4GHz Wireless Transceiver.">RF24</a> configurations match on both receiving and transmitting nRF24L01 transceivers:</p><ol type="1">
<li><code><a class="el" href="classRF24.html#ad5aea7f9a3bd9c7d357fb296ce751f21">RF24::setAddressWidth()</a></code></li>
<li><code><a class="el" href="classRF24.html#a5e6e5a5f6c85d2638381cab2c0f3702e">RF24::setChannel()</a></code></li>
<li><code><a class="el" href="classRF24.html#aeb9920e7a95699748b003c4a839b0814">RF24::setDataRate()</a></code></li>
<li><code><a class="el" href="classRF24.html#aec71746d59da978bcbb975167886a2cc">RF24::setAutoAck()</a></code></li>
<li><code><a class="el" href="classRF24.html#a443888504975d7441d6452a09d09a8fa">RF24::enableDynamicPayloads()</a></code> or <code><a class="el" href="classRF24.html#a486c4c47a6973614ae595ae96f221165">RF24::disableDynamicPayloads()</a></code></li>
<li><code><a class="el" href="classRF24.html#abf8efced2ee9edbcc6510878b20edc1b">RF24::enableAckPayload()</a></code> or <code><a class="el" href="classRF24.html#a00e17eb6b56b915fd6df30a58784661f">RF24::disableAckPayload()</a></code> (requires auto-ack and dynamic payloads features)</li>
<li><code><a class="el" href="classRF24.html#a343e5d23477181011dea030fafb1954f">RF24::setPayloadSize()</a></code> (only if the dynamic payloads feature is disabled &ndash; it is disabled by default)</li>
<li><code><a class="el" href="classRF24.html#a89f626fc4a58dd997153bcc0f8198b9e">RF24::setCRCLength()</a></code> or <code><a class="el" href="classRF24.html#a5eacd9ecfbc19864801d714c292cf8be">RF24::disableCRC()</a></code> (the auto-ack feature automatically enables CRC because it is required)</li>
</ol>
<p>Also, it helps to think of an address as a path (a commonly shared route) instead of an identifying device destination. This means that addresses have to match for a payload to travel from one transceiver to another. However, the pipe numbers assigned with the matching address do not have to match. You can think of pipes as parking spots for the packets, while all packets' payloads live in a TX or RX FIFO buffer. Remember that the TX FIFO buffers and the RX FIFO buffers both have a maximum occupancy of 3 payloads (regardless of the maximum 32-byte payload size).</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Here are the most common issues and their solutions.</h1>
<h2><a class="anchor" id="autotoc_md3"></a>
write() always returns true after setAutoAck(false)</h2>
<p>Don't disabled the auto-ack feature. <a class="el" href="classRF24.html#a4cd4c198a47704db20b6b5cf0731cd58">RF24::write()</a> has no reason to doubt that the payload was delivered if the auto-ack feature is disabled. We recommend you read the docs about <a class="el" href="classRF24.html#aec71746d59da978bcbb975167886a2cc">RF24::setAutoAck()</a> before disabling the auto-ack feature.</p>
<h2><a class="anchor" id="autotoc_md4"></a>
write() returns false when the payload was received</h2>
<p>If the settings match on both endpoint transceivers, then this can only mean that the receiving nRF24L01 failed to send an acknowledgement (ACK) packet back to the transmitting nRF24L01. Usually this is due to instability (electric noise) in the power lines (VCC and GND) going to the receiving nRF24L01.</p>
<p>If you're not receiving ACK packets correctly/reliably on data rates lower than 2MBPS, try adding a big capacitor close to the module/chip. Example issues: <a href="https://github.com/nRF24/RF24/issues/264">#264</a> <a href="https://github.com/nRF24/RF24/issues/211">#211</a>.</p>
<p>For reliability, please use Electrolytic or Tantalum capacitors. Ceramic capacitors may not be good enough (depending on the manufacturing source).</p>
<h2><a class="anchor" id="autotoc_md5"></a>
my PA/LNA module fails to transmit</h2>
<p>You may find variants of the nRF24L01 transceiver that are marketed as “nRF24L01+PA+LNA”. These modules are distinct in the fact that they come with a detachable (SMA-type) antenna. They employ seperate RFX24C01 IC with the antenna for enhanced Power Amplification (PA) and Low Noise Amplification (LNA) features. While they boast greater range with the same functionality, they are subject to a couple lesser known (and lesser advertised) drawbacks:</p>
<ol type="1">
<li>Stronger power source. Below is a chart of advertised current requirements that many MCU boards’ 3V regulators may not be able to provide (after supplying power to internal components). <table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Specification   </th><th class="markdownTableHeadCenter">Value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Emission mode current(peak)   </td><td class="markdownTableBodyCenter">115 mA    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">Receive Mode current(peak)   </td><td class="markdownTableBodyCenter">45 mA    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Power-down mode current   </td><td class="markdownTableBodyCenter">4.2 µA   </td></tr>
</table>
</li>
<li>Needs shielding from electromagnetic interference. Shielding usually works best when it has a path to ground (GND pin), but this connection to the GND pin is not required. It is important that the sheilding does not touch any current carrying parts.<ul>
<li>Professionals tend to use a faraday cage/mesh to implement electromagnetic shielding, but it can be pricey for this scenario.</li>
<li>A quick do-it-yourself solution (as proof-of-concept) would be to wrap the PA/LNA module with electrical tape and then wrap foil around the electrical tape (for shielding) while being very careful to not let the foil touch any current carrying parts (like the GPIO pins, the antenna mount, and the soldier joints for the antenna mount). <br  />
 See <a href="https://github.com/nRF24/RF24/blob/master/images/ghetto_sheilding_1.png"><img src="https://github.com/nRF24/RF24/blob/master/images/ghetto_sheilding_1.png" alt="ghetto_shielding_1.png" class="inline"/></a> and <a href="https://github.com/nRF24/RF24/blob/master/images/ghetto_sheilding_2.png"><img src="https://github.com/nRF24/RF24/blob/master/images/ghetto_sheilding_2.png" alt="ghetto_shielding_2.png" class="inline"/></a> </li>
</ul>
</li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jul 2 2021 11:33:28 for Optimized high speed nRF24L01+ driver class documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
